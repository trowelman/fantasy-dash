<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Fantasy Dash</title>
<style>
html,body{margin:0;background:#0b1020;overflow:hidden;font-family:system-ui,Arial}
#wrap{display:flex;justify-content:center;align-items:center;height:100vh;flex-direction:column;gap:10px}
canvas{background:#101a3a;border-radius:10px}
.row{display:flex;gap:10px;flex-wrap:wrap;justify-content:center}
button{
  padding:10px 16px;
  font-size:14px;
  cursor:pointer;
  border:1px solid rgba(255,255,255,.15);
  background:rgba(255,255,255,.08);
  color:#fff;
  border-radius:10px;
}
button:hover{background:rgba(255,255,255,.14)}
button.primary{background:#ffffff;color:#0b1020;border:none}
button.primary:hover{opacity:.9}
button.sel{outline:2px solid rgba(255,255,255,.55)}
.small{opacity:.85;font-size:13px;color:#cfd6ff;text-align:center}
</style>
</head>
<body>

<div id="wrap">
  <canvas id="c" width="900" height="420"></canvas>

  <div class="row">
    <button id="fsBtn">Fullscreen</button>
    <button id="playBtn" class="primary">Play</button>
  </div>

  <div class="row">
    <button id="easyBtn" class="sel">Easy</button>
    <button id="hardBtn">Hard</button>
  </div>

  <div id="hint" class="small">Choose difficulty, then press Play (or press Space).</div>
</div>

<script>
const c = document.getElementById("c");
const x = c.getContext("2d");

const fsBtn   = document.getElementById("fsBtn");
const playBtn = document.getElementById("playBtn");
const easyBtn = document.getElementById("easyBtn");
const hardBtn = document.getElementById("hardBtn");
const hint    = document.getElementById("hint");

// ---------- Fullscreen ----------
fsBtn.onclick = () => {
  const el = document.documentElement;
  if (el.requestFullscreen) el.requestFullscreen();
};

// ---------- Game State ----------
let state = "menu"; // "menu" | "playing" | "gameover"

// ---------- Difficulty ----------
let difficulty = "easy";
let speed = 6;
let spawnChance = 0.018;

function setDifficulty(mode){
  difficulty = mode;

  if (mode === "easy"){
    speed = 6;
    spawnChance = 0.018;
    easyBtn.classList.add("sel");
    hardBtn.classList.remove("sel");
    hint.textContent = "Easy: slower + fewer blocks. Press Play (or Space).";
  } else {
    speed = 9;
    spawnChance = 0.030;
    hardBtn.classList.add("sel");
    easyBtn.classList.remove("sel");
    hint.textContent = "Hard: faster + more blocks. Press Play (or Space).";
  }
}

easyBtn.onclick = () => setDifficulty("easy");
hardBtn.onclick = () => setDifficulty("hard");

// default
setDifficulty("easy");

// ---------- Game Variables ----------
let y, v, obs, score, best;
best = Number(localStorage.getItem("fd_best") || 0);

function resetRun(){
  y = 300;
  v = 0;
  obs = [];
  score = 0;
}

function startGame(){
  resetRun();
  state = "playing";
}

playBtn.onclick = () => {
  if (state !== "playing") startGame();
};

// ---------- Controls ----------
document.addEventListener("keydown", (e) => {
  if (e.code === "Space") {
    if (state !== "playing") startGame();
    else v = -18; // jump
  }
  if (e.code === "KeyR") {
    state = "menu";
  }
});

c.addEventListener("pointerdown", () => {
  if (state === "playing") v = -18;
});

// ---------- Helpers ----------
function drawCenteredText(text, yPos, size=28, alpha=1){
  x.save();
  x.globalAlpha = alpha;
  x.fillStyle = "#fff";
  x.font = `${size}px system-ui, Arial`;
  const w = x.measureText(text).width;
  x.fillText(text, (c.width - w)/2, yPos);
  x.restore();
}

function loop(){
  // background
  x.clearRect(0,0,c.width,c.height);
  x.fillStyle = "#101a3a";
  x.fillRect(0,0,c.width,c.height);

  // top-left UI
  x.fillStyle="#fff";
  x.font="16px system-ui, Arial";
  x.fillText("Best: " + best, 10, 20);
  x.fillText("Difficulty: " + difficulty.toUpperCase(), 10, 40);

  if (state === "menu") {
    drawCenteredText("Fantasy Dash", 170, 44);
    drawCenteredText("Click Play or press SPACE", 220, 18, 0.9);
    drawCenteredText("Press R anytime for Start Screen", 250, 14, 0.8);

    // preview cube
    x.fillStyle="#4af";
    x.fillRect(120, 300, 40, 40);

    requestAnimationFrame(loop);
    return;
  }

  // gameplay physics
  v += 1;
  y += v;
  if (y > 300) { y = 300; v = 0; }

  // player
  x.fillStyle="#4af";
  x.fillRect(100, y, 40, 40);

  // obstacles spawn + move
  if (Math.random() < spawnChance) obs.push({x:c.width});
  for (const o of obs) {
    o.x -= speed;
    x.fillStyle="#f55";
    x.fillRect(o.x, 300, 30, 40);

    // collision
    const hit = (o.x < 140 && o.x > 60 && y > 260);
    if (hit && state === "playing") state = "gameover";
  }

  // score
  if (state === "playing") score++;
  x.fillStyle="#fff";
  x.fillText("Score: " + score, 10, 60);

  if (state === "gameover") {
    // save best
    if (score > best) {
      best = score;
      localStorage.setItem("fd_best", String(best));
    }
    // overlay
    x.fillStyle="rgba(0,0,0,0.35)";
    x.fillRect(0,0,c.width,c.height);
    drawCenteredText("Game Over", 200, 40);
    drawCenteredText("Press SPACE to restart", 245, 18, 0.9);
    drawCenteredText("Press R for Start Screen", 270, 16, 0.85);
  }

  requestAnimationFrame(loop);
}

loop();
</script>
</body>
</html>

