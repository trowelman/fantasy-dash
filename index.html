<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Fantasy Dash</title>
<style>
html,body{
  margin:0;
  background:#0b1020;
  overflow:hidden;
  font-family:system-ui,Arial
}
#wrap{
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  flex-direction:column;
  gap:10px
}
canvas{
  background:#101a3a;
  border-radius:10px
}
.row{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  justify-content:center
}
button{
  padding:10px 16px;
  font-size:14px;
  cursor:pointer;
  border:1px solid rgba(255,255,255,.15);
  background:rgba(255,255,255,.08);
  color:#fff;
  border-radius:10px
}
button.primary{
  background:#fff;
  color:#0b1020;
  border:none
}
button.sel{
  outline:2px solid rgba(255,255,255,.6)
}
.small{
  font-size:13px;
  color:#cfd6ff;
  opacity:.9;
  text-align:center
}
</style>
</head>
<body>

<div id="wrap">
  <canvas id="c" width="900" height="420"></canvas>

  <div class="row">
    <button id="fsBtn">Fullscreen</button>
    <button id="playBtn" class="primary">Play</button>
  </div>

  <div class="row">
    <button id="easyBtn" class="sel">Easy</button>
    <button id="hardBtn">Hard</button>
  </div>

  <div id="hint" class="small">
    Choose difficulty, then press Play
  </div>
</div>

<script>
/* =======================
   AUDIO (music + sfx)
======================= */
const music = new Audio(
  "https://cdn.pixabay.com/download/audio/2022/10/03/audio_8b2d64d4d3.mp3"
);
music.loop = true;
music.volume = 0.35;

const jumpSound = new Audio(
  "https://cdn.pixabay.com/download/audio/2022/03/15/audio_115b9b4e64.mp3"
);
jumpSound.volume = 0.6;

const gameOverSound = new Audio(
  "https://cdn.pixabay.com/download/audio/2022/03/15/audio_8f03a7ad63.mp3"
);
gameOverSound.volume = 0.6;

/* =======================
   CANVAS + UI
======================= */
const c = document.getElementById("c");
const x = c.getContext("2d");

const fsBtn   = document.getElementById("fsBtn");
const playBtn = document.getElementById("playBtn");
const easyBtn = document.getElementById("easyBtn");
const hardBtn = document.getElementById("hardBtn");
const hint    = document.getElementById("hint");

/* Fullscreen */
fsBtn.onclick = () => {
  if (document.documentElement.requestFullscreen)
    document.documentElement.requestFullscreen();
};

/* =======================
   GAME STATE
======================= */
let state = "menu"; // menu | playing | gameover

/* Difficulty */
let difficulty = "easy";
let speed = 6;
let spawnChance = 0.018;

function setDifficulty(mode){
  difficulty = mode;
  if(mode==="easy"){
    speed = 6;
    spawnChance = 0.018;
    easyBtn.classList.add("sel");
    hardBtn.classList.remove("sel");
  } else {
    speed = 9;
    spawnChance = 0.03;
    hardBtn.classList.add("sel");
    easyBtn.classList.remove("sel");
  }
}
setDifficulty("easy");

easyBtn.onclick = ()=>setDifficulty("easy");
hardBtn.onclick = ()=>setDifficulty("hard");

/* Game variables */
let y, v, obs, score, best;
best = Number(localStorage.getItem("fd_best")||0);

function resetRun(){
  y = 300;
  v = 0;
  obs = [];
  score = 0;
}

function startGame(){
  resetRun();
  state = "playing";
  music.currentTime = 0;
  music.play();
}

playBtn.onclick = ()=>{
  if(state!=="playing") startGame();
};

/* Controls */
document.addEventListener("keydown", e=>{
  if(e.code==="Space"){
    if(state!=="playing"){
      startGame();
    } else {
      v = -18;
      jumpSound.currentTime = 0;
      jumpSound.play();
    }
  }
  if(e.code==="KeyR"){
    state="menu";
    music.pause();
  }
});

c.addEventListener("pointerdown", ()=>{
  if(state==="playing"){
    v = -18;
    jumpSound.currentTime = 0;
    jumpSound.play();
  }
});

/* Helpers */
function centerText(t,y,s=28,a=1){
  x.save();
  x.globalAlpha=a;
  x.fillStyle="#fff";
  x.font=s+"px system-ui";
  const w=x.measureText(t).width;
  x.fillText(t,(c.width-w)/2,y);
  x.restore();
}

/* =======================
   GAME LOOP
======================= */
function loop(){
  x.clearRect(0,0,c.width,c.height);
  x.fillStyle="#101a3a";
  x.fillRect(0,0,c.width,c.height);

  x.fillStyle="#fff";
  x.font="16px system-ui";
  x.fillText("Best: "+best,10,20);
  x.fillText("Difficulty: "+difficulty.toUpperCase(),10,40);

  if(state==="menu"){
    centerText("Fantasy Dash",170,44);
    centerText("Press Play or SPACE",220,18,.9);
    requestAnimationFrame(loop);
    return;
  }

  v+=1;
  y+=v;
  if(y>300){y=300;v=0}

  x.fillStyle="#4af";
  x.fillRect(100,y,40,40);

  if(Math.random()<spawnChance) obs.push({x:c.width});

  for(const o of obs){
    o.x-=speed;
    x.fillStyle="#f55";
    x.fillRect(o.x,300,30,40);
    if(o.x<140&&o.x>60&&y>260&&state==="playing"){
      state="gameover";
      music.pause();
      gameOverSound.play();
    }
  }

  if(state==="playing") score++;
  x.fillText("Score: "+score,10,60);

  if(state==="gameover"){
    if(score>best){
      best=score;
      localStorage.setItem("fd_best",best);
    }
    x.fillStyle="rgba(0,0,0,.4)";
    x.fillRect(0,0,c.width,c.height);
    centerText("Game Over",200,40);
    centerText("Press SPACE to restart",245,18,.9);
    centerText("Press R for menu",270,16,.8);
  }

  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>


